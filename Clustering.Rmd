---
title: "CLustering Unsupervised Machine Learning"
output: html_notebook
---

```{r}
#Load the data
data("USArrests")
mydata <- USArrests

#Remove mising values
mydata <- na.omit(mydata)

#Scale the variables
mydata <- scale(mydata)

head(mydata, n=5)
```
```{r}
#Data preparation example

set.seed(124)
ss <- sample(1:50,10)
df <- USArrests[ss, ]
df <- na.omit(df)
head(df,n=6)

df.scaled <- scale(df)
head(round(df.scaled, 2))
```


```{r}
#Importing packages for clustering

#For clustering
install.packages("cluster")

#For visualization
install.packages("factoextra")

library(cluster)
library(factoextra)

install.packages("corrplot")
```

```{r}
#second argument take value where to apply the function 
#1. for function on rows
#2. for function on columns

desc_stats <- data.frame(
  Min = apply(USArrests, 2, min),
  Max = apply(USArrests, 2, max),
  Med = apply(USArrests, 2, median),
  SD = apply(USArrests, 2, sd),
  Mean = apply(USArrests, 2, mean)
)

desc_stats <- round(desc_stats,1)
head(desc_stats)
```

```{r}
#Functions for computing distances

#dist()#############################################################
library(stats)
eucl <- dist(df.scaled, method = "euclidean" )

#method can be euclidean, manhattan, correlation etc
round(as.matrix(eucl)[1:6,1:6],1)
#t() used for transposing data

#correlation based distance#########################################
#Cor computes coefficient between variables but we need observations 
#so using t() to transpose matrix

print("Correlation method for distance measure")
cor <- cor(t(df.scaled), method = "pearson")
dist_cor <- as.dist(1 - cor)
round(as.matrix(dist_cor)[1:6,1:6],1)

#daisy() to compute dissimilarity matrices between observations 

daisy(df.scaled, metric = c("euclidean", "manhattan", "gower"), stand = FALSE)

#stand: if TRUE, then the measurements in df.scaled are standardized before calculating the dissimilarities. Measurements are standardized for each variable (column), by subtracting the variable’s mean value and dividing by the variable’s mean absolute deviation

data("flower")
head(flower)

str(flower)

daisy_dist <- as.matrix(daisy(flower))
head(round(daisy_dist[1:6,1:6]),2)

#visualizing distance matrices

library(corrplot)
corrplot(as.matrix(eucl), is.corr = FALSE, method = "color")

corrplot(as.matrix(eucl), is.corr = FALSE, method = "color", order = "hclust", type = "upper")

#hierarchial clustering dendrogram 
plot(hclust(eucl, method = "ward.D2"))

#Heatmap
heatmap(as.matrix(eucl), symm = TRUE, distfun = function(x) as.dist(x))
```

